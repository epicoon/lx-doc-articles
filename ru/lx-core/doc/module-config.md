[Английская версия (English version)](https://github.com/epicoon/lx-doc-articles/en/lx-core/doc/module-config.md)

## Конфигурация модуля

### Оглавление
* [Общая информация](#common)
* [Пример конфигурации](#example)
* [aliases и useCommonAliases](#aliases)
* [jsBootstrap и jsMain](#frontend)
* [view](#view)
* [images и css](#assets)
* [respondents](#respondents)


<a name="common"><h3>Общая информация</h3></a>
Следующие утверждения справедливы для конфигурационных файлов модулей:
* Конфигурационные файлы могут быть в форматax: `yaml`, `php`, `json`.
* Если данные конфигурации нет смысла разносить по нескольких файлам, конфигурационный файл может быть один. Тогда он должен иметь имя `config.(yaml|php|json)`.
* Если данные конфигурации удобнее разнести по нескольким файлам, главный файл конфигурации должен иметь имя `main.(yaml|php|json)` и находиться в каталоге `config`.
* Конфигурационный файл (или каталог с конфигурационными файлами) должен располагаться непосредственно в каталоге модуля.
* Есть файл с дефолтной конфигурацией для модулей. Все несконфигурированные параметры в самих модулях будут взяты из дефолтной конфигурации. Путь к данному файлу: `path/to/project/lx/config/module.php`.


<a name="example"><h3>Пример конфигурации</h3></a>
Вариант в синтаксисе `yaml`
```yaml
aliases: []
useCommonAliases: true

frontend: frontend
jsBootstrap: _bootstrap.js
jsMain: _main.js

respondents:
	Respondent: backend\Respondent

view: view
viewIndex: _root.php

images: assets/images
css: assets/css

i18nMap: some\Translater
```


<a name="aliases"><h3>Параметры конфигурации: <b>aliases</b> и <b>useCommonAliases</b></h3></a>
Ключу `aliases` в конфигурации модуля сопоставляется ассоциативный массив, ключами которого являются псевдонимы для путей относительно корневого каталога модуля, а значениями - сами пути. Пример:
```yaml
aliases:
  # Псевдоним для пути относительно каталога модуля
  someAlias: some-directory

  # Псевдоним, объявленный через другой псевдоним
  anotherAlias: @someAlias/directory

  # Можно даже так - для каталога другого модуля
  relativeAlias: {service:another/service-name:anotherModeul}@aliasFromAnotherModule
```
Пример использования псевдонимов:
```php
// Код PHP

// Получение пути
$path = $module->getFileName('@someAlias/someFile');

// Получение файла
$file = $module->getFile('@anotherAlias/someFile');
```
Ключу `useCommonAliases` в конфигурации модуля сопоставляется булево значение, определяющее нужно ли импортировать к данный клас псевдонимы, определенные к общем конфигурационном файле для всех модулей.


<a name="frontend"><h3>Параметры конфигурации: <b>jsBootstrap</b> и <b>jsMain</b></h3></a>
Ключу `jsBootstrap` в конфигурации модуля сопоставляется путь к файлу, содержащему JS-код, который будет выполнен до разворачивания модуля на стороне клиента.<br>
Ключу `jsBootstrap` в конфигурации модуля сопоставляется путь к файлу, содержащему JS-код, который будет выполнен после разворачивания модуля на стороне клиента.


<a name="view"><h3>Параметр конфигурации: <b>view</b></h3></a>
Ключу `view` в конфигурации модуля сопоставляется путь к файлу, содержащему PHP-код, описывающий корневой блок (графический интерфейс) данного модуля.


<a name="assets"><h3>Параметры конфигурации: <b>images</b> и <b>css</b></h3></a>
Ключу `images` в конфигурации модуля сопоставляется путь (или массив путей) к каталогу, содержащему изображения для данного модуля.<br>
Ключу `css` в конфигурации модуля сопоставляется путь (или массив путей) к каталогу, содержащему CSS-файлы, необходимые для данного модуля. Никаких других действий для подключения CSS-файлом предпринимать не нужно - они будут подключены автоматически.


<a name="respondents"><h3>Параметр конфигурации: <b>respondents</b></h3></a>
Респонденты это функциональные элементы модуля. Фактически являются php классами. Представляют собой ajax-контроллеры, которые отдают данные клиентской части модуля.
Пример респондента:
* Определение в конфигурации модуля
```yaml
respondents:
  Respondent: backend\Respondent
```
* Код респондента (согласно приведенной конфигурации должен находиться в файле `backend/Respondent.php` относительно корня модуля)
```php
// Код PHP

namespace path\to\module\backend;

class Respondent extends \lx\Respondent
{
  public function test()
  {
    return 'Hello from server';
  }
}
```
* Использование респондента в js-коде модуля
```js
^Respondent.test() : (result) => {
  // result содержит строку 'Hello from server'
  console.log(result);
};
```
